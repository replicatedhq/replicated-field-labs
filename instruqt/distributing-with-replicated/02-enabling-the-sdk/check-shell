#!/usr/bin/env bash

# download and use our shared library with auto-download functionality
curl -s -o /etc/profile.d/header.sh https://raw.githubusercontent.com/replicatedhq/replicated-field-labs/refactor/crdant/builds-comprehensive-library/libs/header.sh
source /etc/profile.d/header.sh

# Initialize check script
init_check_script

# Use our composite function for complete chart update workflow validation
sdk_version=$(agent variable get REPLICATED_SDK_VERSION)
check_chart_update_workflow \
    "${HOME_DIR}/slackernews/Chart.yaml" \
    "0.2.0" \
    "replicated" \
    "${sdk_version}" \
    "${HOME_DIR}/release" \
    "slackernews"

# Finish check and exit with result
finish_check_script
