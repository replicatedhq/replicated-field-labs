#!/bin/sh
#
# This script runs when the platform setup the challenge.
#
# The platform determines if the script was successful using the exit code of this
# script. If the exit code is not 0, the script fails. 
#
echo "This is challenge 01 setup script"

set -eux


# kubernetes k3s is running
kubectl get nodes 

# install kots cli
curl https://kots.io/install -o /root/kots-install
TAR=`grep kots_linux_amd64 /root/kots-install | awk -F"=" '{print $2}' | sed 's/\"//g'`
echo kots url: $TAR
curl -# -L $TAR -o /root/kots.tar.gz
tar -xvf /root/kots.tar.gz
chmod +x /root/kots
mv /root/kots /usr/local/bin/kubectl-kots

echo "exiting 01-challenge/setup-kubernetes-vm"
exit 0
