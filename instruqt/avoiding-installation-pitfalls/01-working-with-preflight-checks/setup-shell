#!/usr/bin/env bash

# download and use our shared library with auto-download functionality
curl -s -o /etc/profile.d/header.sh https://raw.githubusercontent.com/replicatedhq/replicated-field-labs/refactor/crdant/builds-comprehensive-library/libs/header.sh
source /etc/profile.d/header.sh

# Initialize setup script with proper error handling (debug mode)
init_setup_script true

# Setup common environment variables and agent variables for Replicated
setup_common_environment

# Create empty preflight template file
cat <<EMPTY_PREFLIGHT > ${HOME_DIR}/empty-preflights.yaml
apiVersion: troubleshoot.sh/v1beta2
kind: Preflight
metadata:
  name: empty-preflight-checks
spec:
  analyzers: []
EMPTY_PREFLIGHT
chown replicant ${HOME_DIR}/empty-preflights.yaml


