#!/usr/bin/env bash

# download and use our shared library with auto-download functionality
curl -s -o /etc/profile.d/header.sh https://raw.githubusercontent.com/replicatedhq/replicated-field-labs/refactor/crdant/builds-comprehensive-library/libs/header.sh
source /etc/profile.d/header.sh

# Initialize setup script with proper error handling
init_setup_script

### Ensure tmux session exists and clean it for next challenge
#
# In a test scenario Instruqt does not run the user shell for the
# challenge, which means the tmux session is never established. We
# need the session for solve scripts in other challenges to 
# succeed, so let's create it here and clean it.
#

# Setup tmux session for future challenges
setup_instruqt_tmux_session "shell" "replicant" false

# Clear any hanging output
tmux send-keys -t shell q ENTER
tmux send-keys -t shell clear ENTER

exit 0
